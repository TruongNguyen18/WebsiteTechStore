@model IEnumerable<ProductModel>

@{
    // Nhận pager được truyền từ HomeController
    var pager = ViewBag.Pager as Paginate ?? new Paginate();
}
<div class="section">
    <div class="container">
        <div class="row">
            <!-- SideBarPartial -->
            @* <div id="aside" class="col-md-4">
                @Html.Partial("_SidebarPartial")

            </div> *@
            <div id="aside" class="col-md-3">
                <!-- aside Widget -->
                <div class="aside">
                    <h3 class="aside-title">Loại sản phẩm</h3>
                    <div>
                        <vc:categories></vc:categories>
                    </div>
                </div>
                <!-- /aside Widget -->
                <!-- aside Widget -->
                <div class="aside">
                    <h3 class="aside-title">Thương hiệu</h3>
                    <div>
                        <vc:brands></vc:brands>
                    </div>
                </div>
                <!-- /aside Widget -->
                  
            </div>
            <!-- /ASIDE -->
            <!-- STORE -->
            <div id="store" class="col-md-9">
                <!-- store top filter -->
                @* <div class="store-filter clearfix">
                    <div class="store-sort">

                        <label>
                            Show:
                            <select class="input-select">
                                <option value="0">20</option>
                                <option value="1">50</option>
                            </select>
                        </label>
                    </div>
                    <ul class="store-grid">
                        <li class="active"><i class="fa fa-th"></i></li>
                        <li><a href="#"><i class="fa fa-th-list"></i></a></li>
                    </ul>
                </div> *@
                <!-- /store top filter -->
                <!-- store products -->
                <div class="row-cols-1 row-cols-sm-2 row-cols-md-3 g-4" id="product-grid">
                    @foreach (var item in Model)
                    {
                        <div class="col d-flex">
                            <!-- d-flex để ép card cao 100% -->
                            <div class="product card flex-fill d-flex flex-column text-center">
                                <a asp-action="Details" asp-controller="Product" asp-route-id="@item.Id">
                                    <div class="product-img p-3">
                                        <img src="~/media/products/@item.Image" alt="@item.Name" />
                                    </div>
                                
                                    <div class="product-body flex-fill d-flex flex-column">
                                        <p class="product-category">@item.Category.Name</p>
                                        <h3 class="product-name">@item.Name</h3>
                                        <h4 class="product-price">@item.Price.ToString("#,##0VNĐ")</h4>
                                        </div>
                                </a>
                                <div class="product-body flex-fill d-flex flex-column">
                                        <button class="add-to-cart-btn mt-auto"
                                                onclick="window.location.href='@Url.Action("Add", "Cart", new { id = item.Id })'">
                                            <i class="fa fa-shopping-cart"></i> Thêm vào giỏ hàng
                                        </button>
                                    </div>
                                
                            </div>
                        </div>
                    }
                </div>

                <!-- /store products -->
                <!-- store bottom filter -->
                @if (pager.TotalPages > 1)
                {
                    <div class="store-filter clearfix mt-3">
                        <span class="store-qty">
                            Trang @pager.CurrentPage / @pager.TotalPages — Tổng @pager.TotalItems sản phẩm
                        </span>

                        <ul class="store-pagination">
                            @* First + Prev *@
                            @if (pager.CurrentPage > 1)
                            {
                                <li><a asp-action="Index" asp-route-pg="1">1</a></li>
                                <li><a asp-action="Index" asp-route-pg="@(pager.CurrentPage - 1)"><i class="fa fa-angle-left"></i></a></li>
                            }

                            @for (var p = pager.StartPage; p <= pager.EndPage; p++)
                            {
                                if (p == pager.CurrentPage)
                                {
                                    <li class="active">@p</li>
                                }
                                else
                                {
                                    <li><a asp-action="Index" asp-route-pg="@p">@p</a></li>
                                }
                            }

                            @* Next + Last *@
                            @if (pager.CurrentPage < pager.TotalPages)
                            {
                                <li><a asp-action="Index" asp-route-pg="@(pager.CurrentPage + 1)"><i class="fa fa-angle-right"></i></a></li>
                                <li><a asp-action="Index" asp-route-pg="@pager.TotalPages">@pager.TotalPages</a></li>
                            }
                        </ul>
                    </div>
                }
                <!-- /pagination -->
                <!-- /store bottom filter -->
            </div>
            <!-- /STORE -->
        </div>
        <!-- /row -->
    </div>
    <!-- /container -->
</div>
<!-- /section -->
